{
  "swagger": "2.0",
  "info": {
    "title": "kdo/v1/portfolio.proto",
    "version": "version not set"
  },
  "tags": [
    {
      "name": "PortfolioService"
    }
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/v1/portfolios": {
      "get": {
        "summary": "포트폴리오 목록 조회",
        "operationId": "PortfolioService_ListPortfolios",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/portfolioListPortfoliosResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "pageSize",
            "description": "페이지 크기 (optional)",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pageToken",
            "description": "페이지 토큰 (optional, for pagination)",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "filter",
            "description": "필터\nAvailable filters:\n* is_active\n  * `equal` (true/false)\n* display_name\n  * `equal`, `contains`\n\nExamples:\n* filter=is_active=true\n* filter=display_name:\"ELS\"",
            "in": "query",
            "required": false,
            "type": "string"
          }
        ],
        "tags": [
          "PortfolioService"
        ]
      }
    },
    "/v1/{name}": {
      "get": {
        "summary": "단일 포트폴리오 조회",
        "operationId": "PortfolioService_GetPortfolio",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/portfolioPortfolio"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "name",
            "description": "포트폴리오 리소스 이름 (예: portfolios/1)",
            "in": "path",
            "required": true,
            "type": "string",
            "pattern": "portfolios/[^/]+"
          }
        ],
        "tags": [
          "PortfolioService"
        ]
      }
    },
    "/v1/{name}/exposure": {
      "get": {
        "summary": "포트폴리오 Exposure 조회",
        "operationId": "PortfolioService_GetPortfolioExposure",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/portfolioPortfolioExposure"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "name",
            "description": "포트폴리오 리소스 이름 (예: portfolios/1)",
            "in": "path",
            "required": true,
            "type": "string",
            "pattern": "portfolios/[^/]+"
          }
        ],
        "tags": [
          "PortfolioService"
        ]
      }
    },
    "/v1/{name}/exposure:stream": {
      "get": {
        "summary": "포트폴리오 Exposure 스트림",
        "operationId": "PortfolioService_StreamPortfolioExposure",
        "responses": {
          "200": {
            "description": "A successful response.(streaming responses)",
            "schema": {
              "type": "object",
              "properties": {
                "result": {
                  "$ref": "#/definitions/portfolioPortfolioExposure"
                },
                "error": {
                  "$ref": "#/definitions/rpcStatus"
                }
              },
              "title": "Stream result of portfolioPortfolioExposure"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "name",
            "description": "포트폴리오 리소스 이름 (예: portfolios/1)",
            "in": "path",
            "required": true,
            "type": "string",
            "pattern": "portfolios/[^/]+"
          }
        ],
        "tags": [
          "PortfolioService"
        ]
      }
    },
    "/v1/{name}/pnl": {
      "get": {
        "summary": "포트폴리오 P\u0026L 조회\n포트폴리오 하위 모든 HedgeGroup → Fund의 손익을 집계합니다.",
        "operationId": "PortfolioService_GetPortfolioPnL",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/portfolioPortfolioPnL"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "name",
            "description": "포트폴리오 리소스 이름",
            "in": "path",
            "required": true,
            "type": "string",
            "pattern": "portfolios/[^/]+"
          }
        ],
        "tags": [
          "PortfolioService"
        ]
      }
    },
    "/v1/{name}/pnl:stream": {
      "get": {
        "summary": "포트폴리오 P\u0026L 스트림",
        "operationId": "PortfolioService_StreamPortfolioPnL",
        "responses": {
          "200": {
            "description": "A successful response.(streaming responses)",
            "schema": {
              "type": "object",
              "properties": {
                "result": {
                  "$ref": "#/definitions/portfolioPortfolioPnL"
                },
                "error": {
                  "$ref": "#/definitions/rpcStatus"
                }
              },
              "title": "Stream result of portfolioPortfolioPnL"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "name",
            "description": "포트폴리오 리소스 이름",
            "in": "path",
            "required": true,
            "type": "string",
            "pattern": "portfolios/[^/]+"
          }
        ],
        "tags": [
          "PortfolioService"
        ]
      }
    },
    "/v1/{parent}/funds": {
      "get": {
        "summary": "포트폴리오에 속한 Fund 목록 조회\n(Portfolio → HedgeGroups → Funds)",
        "operationId": "PortfolioService_ListPortfolioFunds",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/portfolioListPortfolioFundsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "parent",
            "description": "부모 포트폴리오 리소스 이름",
            "in": "path",
            "required": true,
            "type": "string",
            "pattern": "portfolios/[^/]+"
          },
          {
            "name": "pageSize",
            "description": "페이지 크기 (optional)",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pageToken",
            "description": "페이지 토큰 (optional)",
            "in": "query",
            "required": false,
            "type": "string"
          }
        ],
        "tags": [
          "PortfolioService"
        ]
      }
    },
    "/v1/{parent}/hedge_groups": {
      "get": {
        "summary": "포트폴리오에 속한 HedgeGroup 목록 조회",
        "operationId": "PortfolioService_ListPortfolioHedgeGroups",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/portfolioListPortfolioHedgeGroupsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "parent",
            "description": "부모 포트폴리오 리소스 이름",
            "in": "path",
            "required": true,
            "type": "string",
            "pattern": "portfolios/[^/]+"
          },
          {
            "name": "pageSize",
            "description": "페이지 크기 (optional)",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pageToken",
            "description": "페이지 토큰 (optional)",
            "in": "query",
            "required": false,
            "type": "string"
          }
        ],
        "tags": [
          "PortfolioService"
        ]
      }
    },
    "/v1/{portfolio.name}": {
      "patch": {
        "summary": "포트폴리오 수정",
        "operationId": "PortfolioService_UpdatePortfolio",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/portfolioPortfolio"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "portfolio.name",
            "description": "포트폴리오 리소스 이름 (예: portfolios/1)",
            "in": "path",
            "required": true,
            "type": "string",
            "pattern": "portfolios/[^/]+"
          },
          {
            "name": "portfolio",
            "description": "수정할 포트폴리오 정보",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "integer",
                  "format": "int32",
                  "title": "포트폴리오 ID",
                  "readOnly": true
                },
                "displayName": {
                  "type": "string",
                  "title": "포트폴리오 이름 (고유)"
                },
                "description": {
                  "type": "string",
                  "title": "포트폴리오 설명"
                },
                "isActive": {
                  "type": "boolean",
                  "title": "활성화 여부"
                },
                "createTime": {
                  "type": "string",
                  "format": "date-time",
                  "title": "생성 시간",
                  "readOnly": true
                },
                "updateTime": {
                  "type": "string",
                  "format": "date-time",
                  "title": "수정 시간",
                  "readOnly": true
                }
              },
              "title": "수정할 포트폴리오 정보",
              "required": [
                "displayName"
              ]
            }
          },
          {
            "name": "updateMask",
            "description": "수정할 필드 마스크",
            "in": "query",
            "required": false,
            "type": "string"
          }
        ],
        "tags": [
          "PortfolioService"
        ]
      }
    }
  },
  "definitions": {
    "portfolioFundSummary": {
      "type": "object",
      "properties": {
        "code": {
          "type": "string",
          "title": "펀드 코드"
        },
        "name": {
          "type": "string",
          "title": "펀드 이름"
        },
        "hedgeGroupId": {
          "type": "integer",
          "format": "int32",
          "title": "속한 헷지그룹 ID"
        },
        "hedgeGroupName": {
          "type": "string",
          "title": "속한 헷지그룹 이름"
        }
      },
      "title": "Fund 요약 정보 (포트폴리오 컨텍스트)"
    },
    "portfolioFundSymbolPosition": {
      "type": "object",
      "properties": {
        "fundCode": {
          "type": "string",
          "title": "펀드 코드"
        },
        "symbol": {
          "type": "string",
          "title": "종목 심볼"
        },
        "quantity": {
          "type": "string",
          "format": "int64",
          "title": "수량"
        },
        "averageCost": {
          "type": "number",
          "format": "double",
          "title": "평균 매입 단가"
        },
        "currentPrice": {
          "type": "number",
          "format": "double",
          "title": "현재가"
        },
        "unrealizedPnl": {
          "type": "string",
          "format": "int64",
          "title": "미실현 손익"
        }
      },
      "title": "Fund별 심볼 포지션 (상세)"
    },
    "portfolioHedgeGroupSummary": {
      "type": "object",
      "properties": {
        "id": {
          "type": "integer",
          "format": "int32",
          "title": "헷지그룹 ID"
        },
        "name": {
          "type": "string",
          "title": "헷지그룹 이름"
        },
        "hedgeMethod": {
          "type": "string",
          "title": "헷지 방식"
        },
        "triggerCondition": {
          "type": "string",
          "title": "트리거 조건"
        },
        "fundCount": {
          "type": "integer",
          "format": "int32",
          "title": "하위 펀드 수"
        },
        "isActive": {
          "type": "boolean",
          "title": "활성화 여부"
        }
      },
      "title": "HedgeGroup 요약 정보 (포트폴리오 컨텍스트)"
    },
    "portfolioListPortfolioFundsResponse": {
      "type": "object",
      "properties": {
        "funds": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/portfolioFundSummary"
          },
          "title": "펀드 목록"
        },
        "nextPageToken": {
          "type": "string",
          "title": "다음 페이지 토큰"
        }
      },
      "title": "ListPortfolioFunds 응답"
    },
    "portfolioListPortfolioHedgeGroupsResponse": {
      "type": "object",
      "properties": {
        "hedgeGroups": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/portfolioHedgeGroupSummary"
          },
          "title": "헷지그룹 목록"
        },
        "nextPageToken": {
          "type": "string",
          "title": "다음 페이지 토큰"
        }
      },
      "title": "ListPortfolioHedgeGroups 응답"
    },
    "portfolioListPortfoliosResponse": {
      "type": "object",
      "properties": {
        "portfolios": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/portfolioPortfolio"
          },
          "title": "포트폴리오 목록"
        },
        "nextPageToken": {
          "type": "string",
          "title": "다음 페이지 토큰"
        }
      },
      "title": "ListPortfolios 응답"
    },
    "portfolioNetExposure": {
      "type": "object",
      "properties": {
        "symbol": {
          "type": "string",
          "title": "종목 심볼"
        },
        "netQuantity": {
          "type": "number",
          "format": "double",
          "title": "누적 수량 (분해 후 합산, 소수점 2자리)"
        },
        "currentPrice": {
          "type": "number",
          "format": "double",
          "title": "현재가"
        },
        "exposureAmount": {
          "type": "string",
          "format": "int64",
          "title": "익스포저 금액 (net_quantity * current_price)"
        }
      },
      "title": "Net Exposure (변환된 포지션)"
    },
    "portfolioNetExposures": {
      "type": "object",
      "properties": {
        "exposures": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/portfolioNetExposure"
          },
          "title": "심볼별 Net Exposure"
        },
        "totalQuantity": {
          "type": "number",
          "format": "float",
          "title": "전체 수량 합계"
        },
        "totalExposure": {
          "type": "string",
          "format": "int64",
          "title": "전체 익스포저 금액"
        }
      },
      "title": "Net Exposures 집계 구조체 (Hedge 변환 후 상계된 결과)"
    },
    "portfolioPortfolio": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "title": "포트폴리오 리소스 이름 (예: portfolios/1)",
          "readOnly": true
        },
        "id": {
          "type": "integer",
          "format": "int32",
          "title": "포트폴리오 ID",
          "readOnly": true
        },
        "displayName": {
          "type": "string",
          "title": "포트폴리오 이름 (고유)"
        },
        "description": {
          "type": "string",
          "title": "포트폴리오 설명"
        },
        "isActive": {
          "type": "boolean",
          "title": "활성화 여부"
        },
        "createTime": {
          "type": "string",
          "format": "date-time",
          "title": "생성 시간",
          "readOnly": true
        },
        "updateTime": {
          "type": "string",
          "format": "date-time",
          "title": "수정 시간",
          "readOnly": true
        }
      },
      "title": "포트폴리오 정보\nP\u0026L(손익) 집계 단위",
      "required": [
        "displayName"
      ]
    },
    "portfolioPortfolioExposure": {
      "type": "object",
      "properties": {
        "portfolio": {
          "type": "string",
          "title": "포트폴리오 리소스 이름"
        },
        "portfolioId": {
          "type": "integer",
          "format": "int32",
          "title": "포트폴리오 ID"
        },
        "positions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/portfolioSymbolPosition"
          },
          "title": "심볼별 통합 포지션 (모든 Fund 합산)"
        },
        "fundPositions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/portfolioFundSymbolPosition"
          },
          "title": "Fund별 심볼 포지션 (상세 추적용)"
        },
        "realizedPnl": {
          "type": "string",
          "format": "int64",
          "title": "실현 손익 (당일)"
        },
        "unrealizedPnl": {
          "type": "string",
          "format": "int64",
          "title": "미실현 손익 (현재가 기준)"
        },
        "tradingCost": {
          "type": "string",
          "format": "int64",
          "title": "거래 비용 (수수료 등)"
        },
        "netPnl": {
          "type": "string",
          "format": "int64",
          "title": "순손익 (realized + unrealized - trading_cost)"
        },
        "totalNetQuantity": {
          "type": "string",
          "format": "int64",
          "title": "전체 net exposure 수량"
        },
        "totalExposureAmount": {
          "type": "string",
          "format": "int64",
          "title": "전체 exposure 금액"
        },
        "netExposures": {
          "$ref": "#/definitions/portfolioNetExposures",
          "title": "Net Exposures (Hedge 변환 후 상계된 결과)\npositions를 nettings 설정에 따라 분해/변환한 결과"
        },
        "lastUpdate": {
          "type": "string",
          "format": "date-time",
          "title": "마지막 업데이트 시간"
        }
      },
      "title": "포트폴리오 Exposure (실시간 포지션 및 손익 추적)",
      "required": [
        "portfolio"
      ]
    },
    "portfolioPortfolioPnL": {
      "type": "object",
      "properties": {
        "portfolio": {
          "type": "string",
          "title": "포트폴리오 리소스 이름"
        },
        "portfolioId": {
          "type": "integer",
          "format": "int32",
          "title": "포트폴리오 ID"
        },
        "portfolioName": {
          "type": "string",
          "title": "포트폴리오 이름"
        },
        "realizedPnl": {
          "type": "string",
          "format": "int64",
          "title": "실현 손익 (원)"
        },
        "unrealizedPnl": {
          "type": "string",
          "format": "int64",
          "title": "미실현 손익 (원)"
        },
        "tradingCost": {
          "type": "string",
          "format": "int64",
          "title": "거래 비용 (원)"
        },
        "netPnl": {
          "type": "string",
          "format": "int64",
          "title": "순손익 (realized + unrealized - trading_cost)"
        },
        "fundCount": {
          "type": "integer",
          "format": "int32",
          "title": "하위 펀드 수"
        },
        "hedgeGroupCount": {
          "type": "integer",
          "format": "int32",
          "title": "하위 헷지그룹 수"
        },
        "symbolPnls": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/portfolioSymbolPnLDetail"
          },
          "title": "종목별 P\u0026L 상세"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "title": "스냅샷 시간"
        }
      },
      "title": "포트폴리오 P\u0026L 집계 결과",
      "required": [
        "portfolio"
      ]
    },
    "portfolioSymbolPnLDetail": {
      "type": "object",
      "properties": {
        "symbol": {
          "type": "string",
          "title": "종목 코드"
        },
        "quantity": {
          "type": "number",
          "format": "double",
          "title": "보유 수량"
        },
        "averageEntryPrice": {
          "type": "number",
          "format": "double",
          "title": "평균 진입가"
        },
        "currentPrice": {
          "type": "number",
          "format": "double",
          "title": "현재가"
        },
        "unrealizedPnl": {
          "type": "string",
          "format": "int64",
          "title": "미실현 손익"
        },
        "realizedPnl": {
          "type": "string",
          "format": "int64",
          "title": "실현 손익"
        },
        "tradingCost": {
          "type": "string",
          "format": "int64",
          "title": "거래 비용"
        }
      },
      "title": "종목별 P\u0026L 상세"
    },
    "portfolioSymbolPosition": {
      "type": "object",
      "properties": {
        "symbol": {
          "type": "string",
          "title": "종목 심볼"
        },
        "netQuantity": {
          "type": "string",
          "format": "int64",
          "title": "순수량 (long - short, 모든 Fund 합산)"
        },
        "averageCost": {
          "type": "number",
          "format": "double",
          "title": "평균 매입 단가"
        },
        "currentPrice": {
          "type": "number",
          "format": "double",
          "title": "현재가"
        },
        "unrealizedPnl": {
          "type": "string",
          "format": "int64",
          "title": "미실현 손익"
        },
        "exposureAmount": {
          "type": "string",
          "format": "int64",
          "title": "익스포저 금액 (net_quantity * current_price)"
        }
      },
      "title": "심볼별 통합 포지션"
    },
    "protobufAny": {
      "type": "object",
      "properties": {
        "@type": {
          "type": "string"
        }
      },
      "additionalProperties": {}
    },
    "rpcStatus": {
      "type": "object",
      "properties": {
        "code": {
          "type": "integer",
          "format": "int32"
        },
        "message": {
          "type": "string"
        },
        "details": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/protobufAny"
          }
        }
      }
    }
  }
}
